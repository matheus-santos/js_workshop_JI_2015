var todosList=function(o,t){"use strict";function n(o,t){var n=new XMLHttpRequest;n.open("GET",o),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var o=n.getResponseHeader("Content-Type");o.match(/json/)&&t(n.responseText)}},n.send(null)}function e(o){var t,n="";o=JSON.parse(o);for(var e=0;e<o.length;e++)t=o[e],n+=["<li class='todo'>","<div class='todo-header'>","<span class='todo-author'>",t.author_name,"</span> added","</div>","<div class='todo-content'>","<input type='checkbox' name='todo-checkbox' ","value='",t._id,"' class='todo-checkbox' />","<span class='todo-text'>",t.text,"</span>","</div>","</li>"].join("");var s=document.getElementsByClassName("todos-list")[0];s.innerHTML=n}function s(){n(o.props.url,e)}function a(){s()}return{init:a}}(endpoints);todosList.init();var todosList=function(o,t,n){"use strict";function e(){o.ajax({url:t.props.url,type:"GET",cache:!1,dataType:"json",crossDomain:!0,success:function(o){a(o)},error:function(o,n,e){console.error(t.props.url,n,e.toString())}})}function s(){console.log("Loading todo list.."),e(),setInterval(e,2e3)}var a=function(t){var n="";o.each(t,function(o,t){n+=["<li class='todo'>","<div class='todo-header'>","<span class='todo-author'>",t.author_name,"</span> added","</div>","<div class='todo-content'>","<input type='checkbox' name='todo-checkbox' ","value='",t._id,"' class='todo-checkbox' />","<span class='todo-text'>",t.text,"</span>","</div>","</li>"].join("")}),o(".todos-list").html(n)};return{init:s}}(jQuery,endpoints);todosList.init(),$(".todos-list").on({click:function(o){console.log("Todo finished!");var t=$(this),n=t.parents(".todo");n.fadeOut(),$.ajax({url:[endpoints.props.url,t.val()].join("/"),type:"DELETE",cache:!1,dataType:"json",crossDomain:!0}).done(function(o){console.log(o)}).fail(function(){alert("Error!")}).always(function(){console.log("complete")})}},".todo .todo-checkbox"),$(".js-todo-add-btn").on({click:function(){console.log("New todo!");var o=$(this),t=o.siblings(".todo-add-author-name").val(),n=o.siblings(".todo-add-text").val();$.ajax({url:endpoints.props.url,type:"POST",dataType:"json",data:{author_name:t,text:n}}).done(function(o){console.log(o)}).fail(function(){alert("error")}).always(function(){console.log("complete")})}});